<!DOCTYPE html>
<html>
<head>
    <title>Quick File Check</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        pre { background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Quick File Type Check</h1>
    <div id="results">Loading...</div>

    <script type="importmap">
    {
        "imports": {
            "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"
        }
    }
    </script>

    <script type="module">
        import { getUserFiles } from './js/file-service.js';
        import { guardPage } from './js/auth-guard.js';

        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const allowed = await guardPage({ requireVerified: false });
                if (!allowed) {
                    document.getElementById('results').innerHTML = 'Not authenticated';
                    return;
                }

                const result = await getUserFiles({ pageSize: 3 });
                
                let html = `<h3>First 3 files:</h3>`;
                result.files.forEach((file, i) => {
                    html += `<h4>File ${i+1}: ${file.fileName}</h4>`;
                    html += `<pre>${JSON.stringify(file, null, 2)}</pre>`;
                });
                
                document.getElementById('results').innerHTML = html;
            } catch (error) {
                document.getElementById('results').innerHTML = `Error: ${error.message}`;
            }
        });
    </script>
</body>
</html>